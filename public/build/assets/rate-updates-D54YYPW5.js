$(function(){const t=$(".select2");t.length&&t.each(function(){var a=$(this);a.wrap('<div class="position-relative"></div>').select2({placeholder:"Select value",dropdownParent:a.parent()})})});var l=$(".datatables-rate-update"),c=$(".start_date"),d=$(".end_date");$("#offCanvasForm");$.ajaxSetup({headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")}});var u=$("html").attr("dir")==="rtl",i=$(".flatpickr-range"),f="MM/DD/YYYY";i.length&&i.flatpickr({mode:"range",dateFormat:"m/d/Y",orientation:u?"auto right":"auto left",locale:{format:f},onClose:function(t){var a="",e=new Date;t[0]!=null&&(a=moment(t[0]).format("MM/DD/YYYY"),c.val(a)),t[1]!=null&&(e=moment(t[1]).format("MM/DD/YYYY"),d.val(e)),$(i).trigger("change").trigger("keyup")}});if(l.length){var r=l.DataTable({dom:"<'row'<'col-sm-12'tr>><'row'<'col-sm-12 col-md-6'i><'col-sm-12 col-md-6 dataTables_pager'p>>",ajax:{url:baseUrl+"currency-management/filter",type:"POST",data:function(t){t.code=$("#code").val(),t.currency=$("#currency").val(),t.statuss=$("#statuss").val(),t.per_page=$("#per_page").val(),t.date=$("#date").val()}},columns:[{data:"code",title:"Code"},{data:"name",title:"Name"},{data:"country",title:"Country"},{data:"type",title:"Type"},{data:"min_rate_limit",title:"Min Rate Limit"},{data:"max_rate_limit",title:"Max Rate Limit"},{data:"status",title:"Status"},{data:"rate",title:"Rate"},{data:"",title:""},{data:"action",title:"Action"}],columnDefs:[{targets:0,render:function(t,a,e,n){return`<span>${e.code}</span>`}},{targets:1,render:function(t,a,e,n){return`<span>${e.name}</span>`}},{targets:2,render:function(t,a,e,n){return`<span>${e.country}</span>`}},{targets:3,render:function(t,a,e,n){return e.type===0?'<span class="badge bg-warning badge-sm">Divide</span>':'<span class="badge bg-success badge-sm">Multiply</span>'}},{targets:4,render:function(t,a,e,n){return`<span>${e.min_rate_limit}</span>`}},{targets:5,render:function(t,a,e,n){return`<span>${e.max_rate_limit}</span>`}},{targets:6,render:function(t,a,e,n){return e.status==1?'<i class="ti fs-4 ti-shield-check text-success"></i>':'<i class="ti fs-4 ti-shield-x text-danger"></i>'}},{targets:7,render:function(t,a,e,n){return`<span>${e.rate}</span>`}},{targets:8,render:function(t,a,e,n){return'<input type="number" class="form-control input-rate" value="" />'}},{targets:-1,searchable:!1,orderable:!1,render:function(t,a,e,n){return`<div class="d-flex align-items-center gap-50"><button class="btn btn-sm btn-icon edit-record btn-text-secondary rounded-pill waves-effect" data-id="${e.id}" data-bs-toggle="offcanvas" data-bs-target="#offcanvasAddUser"><i class="ti ti-plus"></i></button></div>`}}],language:{paginate:{next:'<i class="ti ti-chevron-right ti-sm"></i>',previous:'<i class="ti ti-chevron-left ti-sm"></i>'}},orderCellsTop:!0});$("input.dt-input").on("keyup",function(){r.ajax.reload(null,!1)}),$("#date").on("change",function(){r.ajax.reload(null,!1)}),$("#statuss, #per_page").on("change",function(){r.ajax.reload(null,!1)})}$(document).on("click",".edit-record",function(){var t=$(this).data("id"),a=$(this).closest("tr").find("input.input-rate").val(),e=$("#date").val();if(!a||isNaN(a)||a<=0){Swal.fire({title:"Invalid Input!",text:"Please enter a valid rate greater than 0.",icon:"error",customClass:{confirmButton:"btn btn-danger"}});return}$.ajax({url:baseUrl+"update-rates",method:"POST",data:{id:t,rate:a,date:e},success:function(n){Swal.fire({icon:"success",title:`Successfully ${n}!`,text:`Rate ${n} Successfully.`,customClass:{confirmButton:"btn btn-success"}}),r.ajax.reload(null,!1)},error:function(n){const s=n.responseJSON,o=s&&s.message?s.message:"An error occurred. Please try again.";Swal.fire({title:"Error!",text:o,icon:"error",customClass:{confirmButton:"btn btn-danger"}})}})});
