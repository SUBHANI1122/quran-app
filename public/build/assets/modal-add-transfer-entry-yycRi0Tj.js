$(function(){const e=$(".select2");e.length&&e.each(function(){var t=$(this);t.wrap('<div class="position-relative"></div>').select2({placeholder:"Select value",dropdownParent:t.parent()})})});$("#account_id").on("change",function(){const e=this.value;if(e){const n=this.options[this.selectedIndex].getAttribute("data-currency"),r=document.getElementById("currency-symbol");r.textContent=n||"@";const s=document.getElementById("fc");n==="GBP"?s.readOnly=!0:s.readOnly=!1,document.getElementById("rate").value="",fetch(`/get-rate/${e}`).then(o=>o.json()).then(o=>{o.success?document.getElementById("rate").value=o.rate:Swal.fire({title:"Rate Error!",text:"Rate not found for the selected account.",icon:"error",customClass:{confirmButton:"btn btn-success"}})}).catch(o=>{console.error("Error fetching rate:",o)})}else document.getElementById("rate").value=""});document.getElementById("fc").addEventListener("input",function(){const e=parseFloat(document.getElementById("rate").value)||0,t=parseFloat(this.value)||0;document.getElementById("account_id").value,document.getElementById("account_id").options[document.getElementById("account_id").selectedIndex].getAttribute("data-currency")!=="GBP"&&e>0&&(document.getElementById("lc").value=(t/e).toFixed(2))});document.getElementById("lc").addEventListener("input",function(){const e=parseFloat(document.getElementById("rate").value)||0,t=parseFloat(this.value)||0;document.getElementById("account_id").value,document.getElementById("account_id").options[document.getElementById("account_id").selectedIndex].getAttribute("data-currency")!=="GBP"&&e>0&&(document.getElementById("fc").value=(t*e).toFixed(2))});$(".datatables-currency");$(".start_date");$(".end_date");$("#offCanvasForm");$.ajaxSetup({headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")}});$("html").attr("dir");$(".add-new").on("click",function(){$("#id").val(""),$("#offcanvasAddUserLabel").html("Add Transfer Entry")});FormValidation.formValidation(document.getElementById("addTransferEntryForm"),{fields:{account_id:{validators:{notEmpty:{message:"Please select Account"}}},posting_date:{validators:{notEmpty:{message:"Please select Date"}}},type:{validators:{notEmpty:{message:"Please select type"}}},lc:{validators:{notEmpty:{message:"Please enter lc amount"}}},description:{validators:{notEmpty:{message:"Please enter description"}}}},plugins:{trigger:new FormValidation.plugins.Trigger,bootstrap5:new FormValidation.plugins.Bootstrap5({eleValidClass:"",rowSelector:".col-12"}),submitButton:new FormValidation.plugins.SubmitButton,autoFocus:new FormValidation.plugins.AutoFocus}}).on("core.form.valid",function(){$.ajax({data:$("#addTransferEntryForm").serialize(),url:`${baseUrl}transfer-entry`,type:"POST",success:function(e){$("#addTransferEntryForm")[0].reset(),$(".select2").val(null).trigger("change"),$("#addTransferEntry").modal("hide"),Swal.fire({icon:"success",title:`Successfully ${e}!`,text:`Currency ${e} Successfully.`,customClass:{confirmButton:"btn btn-success"}}),window.location.reload(!0)},error:function(e){var n;const t=((n=e.responseJSON)==null?void 0:n.error)||"An unexpected error occurred.";Swal.fire({title:"Error",text:t,icon:"error",customClass:{confirmButton:"btn btn-success"}})}})});$(document).on("click",".edit-record",function(){var e=$(this).data("id");$("#addTransferEntry").modal("show"),$("#offcanvasAddUserLabel").html("Edit Transfer Entry"),$.get(`${baseUrl}transfer-entry/${e}/edit`,function(t){$("#user_id").val(t.id),$("#posting_date").val(t.posting_date),$("#account_id").val(t.account_id).trigger("change"),$("#type").val(t.type).trigger("change"),$("#fc").val(t.fc),$("#lc").val(t.lc),$("#description").val(t.description)})});$(document).on("click",".delete-record",function(){var e=$(this).data("id");Swal.fire({title:"Are you sure?",text:"You won't be able to delete this!",icon:"warning",showCancelButton:!0,confirmButtonText:"Yes, delete it!",customClass:{confirmButton:"btn btn-primary me-3",cancelButton:"btn btn-label-secondary"},buttonsStyling:!1}).then(function(t){t.isConfirmed?$.ajax({type:"DELETE",url:`${baseUrl}transfer-entry/${e}`,headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},success:function(n){Swal.fire({icon:"success",title:"Deleted!",text:n.message,customClass:{confirmButton:"btn btn-success"}}),$(`#entry-${e}`).remove(),window.location.reload(!0)},error:function(n){Swal.fire({icon:"error",title:"Error!",text:n.responseJSON?n.responseJSON.message:"An error occurred while deleting.",customClass:{confirmButton:"btn btn-danger"}}),console.log(n)}}):t.dismiss===Swal.DismissReason.cancel&&Swal.fire({title:"Cancelled",text:"Transfer entry is not deleted!",icon:"error",customClass:{confirmButton:"btn btn-success"}})})});$(document).on("click",".post-record",function(){Swal.fire({title:"Are you sure?",text:"This will post all entries and record will be pending for approvel!",icon:"warning",showCancelButton:!0,confirmButtonText:"Yes, post it!",customClass:{confirmButton:"btn btn-primary me-3",cancelButton:"btn btn-label-secondary"},buttonsStyling:!1}).then(function(e){e.value?$.ajax({type:"PATCH",url:`${baseUrl}transfer-entries/post`,success:function(t){Swal.fire({icon:"success",title:"Posted!",text:t.message,customClass:{confirmButton:"btn btn-success"}}),window.location.reload(!0)},error:function(t){console.error(t),Swal.fire({icon:"error",title:"Error!",text:"There was an issue posting the entries.",customClass:{confirmButton:"btn btn-danger"}})}}):e.dismiss===Swal.DismissReason.cancel&&Swal.fire({title:"Cancelled",text:"No changes were made.",icon:"error",customClass:{confirmButton:"btn btn-success"}})})});
