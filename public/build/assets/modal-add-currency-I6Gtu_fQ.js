$(function(){const e=$(".select2");e.length&&e.each(function(){var t=$(this);t.wrap('<div class="position-relative"></div>').select2({placeholder:"Select value",dropdownParent:t.parent()})})});var s=$(".datatables-currency"),l=$(".start_date"),c=$(".end_date");$("#offCanvasForm");$.ajaxSetup({headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")}});var o=$("html").attr("dir")==="rtl",n=$(".flatpickr-range"),u="MM/DD/YYYY";n.length&&n.flatpickr({mode:"range",dateFormat:"m/d/Y",orientation:o?"auto right":"auto left",locale:{format:u},onClose:function(e){var t="",a=new Date;e[0]!=null&&(t=moment(e[0]).format("MM/DD/YYYY"),l.val(t)),e[1]!=null&&(a=moment(e[1]).format("MM/DD/YYYY"),c.val(a)),$(n).trigger("change").trigger("keyup")}});if(s.length){var i=s.DataTable({dom:"<'row'<'col-sm-12'tr>><'row'<'col-sm-12 col-md-6'i><'col-sm-12 col-md-6 dataTables_pager'p>>",ajax:{url:baseUrl+"currency-management/filter",type:"POST",data:function(e){e.code=$("#code").val(),e.currency=$("#currency").val(),e.statuss=$("#statuss").val(),e.per_page=$("#per_page").val()}},columns:[{data:"code",title:"Code"},{data:"name",title:"Name"},{data:"country",title:"Country"},{data:"type",title:"Type"},{data:"min_rate_limit",title:"Min Rate Limit"},{data:"max_rate_limit",title:"Max Rate Limit"},{data:"status",title:"Status"},{data:"updated_at",title:"Updated At"},{data:"action",title:"Action"}],columnDefs:[{targets:0,render:function(e,t,a,r){return`<span>${a.code}</span>`}},{targets:1,render:function(e,t,a,r){return`<span>${a.name}</span>`}},{targets:2,render:function(e,t,a,r){return`<span>${a.country}</span>`}},{targets:3,render:function(e,t,a,r){return a.type===0?'<span class="badge bg-warning badge-sm">Divide</span>':'<span class="badge bg-success badge-sm">Multiply</span>'}},{targets:4,render:function(e,t,a,r){return`<span>${a.min_rate_limit}</span>`}},{targets:5,render:function(e,t,a,r){return`<span>${a.max_rate_limit}</span>`}},{targets:6,render:function(e,t,a,r){return a.status==1?'<i class="ti fs-4 ti-shield-check text-success"></i>':'<i class="ti fs-4 ti-shield-x text-danger"></i>'}},{targets:7,render:function(e,t,a,r){return`<span>${a.updated_at}</span>`}},{targets:-1,searchable:!1,orderable:!1,render:function(e,t,a,r){return`<div class="d-flex align-items-center gap-50"><button class="btn btn-sm btn-icon edit-record btn-text-secondary rounded-pill waves-effect" data-id="${a.id}" data-bs-toggle="offcanvas" data-bs-target="#offcanvasAddUser"><i class="ti ti-edit"></i></button></div>`}}],language:{paginate:{next:'<i class="ti ti-chevron-right ti-sm"></i>',previous:'<i class="ti ti-chevron-left ti-sm"></i>'}},orderCellsTop:!0});$("input.dt-input").on("keyup",function(){i.ajax.reload(null,!1)}),$("#statuss, #per_page").on("change",function(){i.ajax.reload(null,!1)})}$("#currency_id").on("change",function(){var e=$(this).find("option:selected");$("#symbol").val(e.data("symbol")),$("#country").val(e.data("country"))});$(".add-new").on("click",function(){$("#id").val(""),$("#offcanvasAddUserLabel").html("Add Currency")});$(document).on("click",".edit-record",function(){var e=$(this).data("id");$("#addCurrency").modal("show"),$("#offcanvasAddUserLabel").html("Edit Currency"),$.get(`${baseUrl}currency-management/${e}/edit`,function(t){$("#user_id").val(t.id),$("#currency_id").val(t.currency_id).trigger("change"),$("#type").val(t.type).trigger("change"),$("#status").val(t.status).trigger("change"),$("#re_value").val(t.re_value).trigger("change"),$("#profit").val(t.profit).trigger("change"),$("#min_rate_limit").val(t.min_rate_limit),$("#max_rate_limit").val(t.max_rate_limit),$("#auto_create_unpaid_tranx_account").prop("checked",t.auto_create_unpaid_tranx_account==1),$("#auto_create_unearned_admin_service_fee_account").prop("checked",t.auto_create_unearned_admin_service_fee_account==1),$("#auto_create_unearned_agent_service_fee_account").prop("checked",t.auto_create_unearned_agent_service_fee_account==1)})});FormValidation.formValidation(document.getElementById("addCurrencyForm"),{fields:{currency_id:{validators:{notEmpty:{message:"Please select Currency"}}},type:{validators:{notEmpty:{message:"Please select type"}}},status:{validators:{notEmpty:{message:"Please select status"}}},re_value:{validators:{notEmpty:{message:"Please select Re Value"}}},profit:{validators:{notEmpty:{message:"Please select profit"}}},min_rate_limit:{validators:{notEmpty:{message:"Please enter minimum rate limit"},numeric:{message:"The value must be a valid number"}}},max_rate_limit:{validators:{notEmpty:{message:"Please select maximum rate limit"},numeric:{message:"The value must be a valid number"}}}},plugins:{trigger:new FormValidation.plugins.Trigger,bootstrap5:new FormValidation.plugins.Bootstrap5({eleValidClass:"",rowSelector:".col-12"}),submitButton:new FormValidation.plugins.SubmitButton,autoFocus:new FormValidation.plugins.AutoFocus}}).on("core.form.valid",function(){$.ajax({data:$("#addCurrencyForm").serialize(),url:`${baseUrl}currency-management`,type:"POST",success:function(e){$("#addCurrencyForm")[0].reset(),$(".select2").val(null).trigger("change"),$("#addCurrency").modal("hide"),Swal.fire({icon:"success",title:`Successfully ${e}!`,text:`Currency ${e} Successfully.`,customClass:{confirmButton:"btn btn-success"}}),i.ajax.reload(null,!1)},error:function(){Swal.fire({title:"Duplicate Entry!",text:"Your email should be unique.",icon:"error",customClass:{confirmButton:"btn btn-success"}})}})});
