$(function(){const t=$(".select2");t.length&&t.each(function(){var e=$(this);e.wrap('<div class="position-relative"></div>').select2({placeholder:"Select value",dropdownParent:e.parent()})})});var s=$(".datatables-chart-of-account"),c=$(".start_date"),o=$(".end_date");$("#offCanvasForm");$.ajaxSetup({headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")}});var l=$("html").attr("dir")==="rtl",r=$(".flatpickr-range"),u="MM/DD/YYYY";r.length&&r.flatpickr({mode:"range",dateFormat:"m/d/Y",orientation:l?"auto right":"auto left",locale:{format:u},onClose:function(t){var e="",a=new Date;t[0]!=null&&(e=moment(t[0]).format("MM/DD/YYYY"),c.val(e)),t[1]!=null&&(a=moment(t[1]).format("MM/DD/YYYY"),o.val(a)),$(r).trigger("change").trigger("keyup")}});$("#currency_id").on("change",function(){var t=$(this).find("option:selected"),e=t.data("symbol"),a=t.data("name");$("#currency_symbol").val(a+" - "+e)});if(s.length){var i=s.DataTable({dom:"<'row'<'col-sm-12'tr>><'row'<'col-sm-12 col-md-6'i><'col-sm-12 col-md-6 dataTables_pager'p>>",ajax:{url:baseUrl+"chart-of-account/filter",type:"POST",data:function(t){t.prefix=$("#prefix").val(),t.account_name=$("#account_name").val(),t.statuss=$("#statuss").val(),t.currency=$("#currency").val()}},columns:[{data:"code",title:"Code"},{data:"name",title:"Name"},{data:"prefix",title:"Prefix"},{data:"type",title:"Type"},{data:"classification",title:"Classification"},{data:"country",title:"Country"},{data:"currency",title:"Currency"},{data:"status",title:"Status"},{data:"action",title:""}],columnDefs:[{targets:0,render:function(t,e,a,n){return`<span>${a.code}</span>`}},{targets:1,render:function(t,e,a,n){return`<span>${a.name}</span>`}},{targets:2,render:function(t,e,a,n){return`<span>${a.prefix}</span>`}},{targets:3,render:function(t,e,a,n){return`<span>${a.type}</span>`}},{targets:4,render:function(t,e,a,n){return`<span>${a.classification}</span>`}},{targets:5,render:function(t,e,a,n){return`<span>${a.country}</span>`}},{targets:6,render:function(t,e,a,n){return`<span>${a.currency}</span>`}},{targets:7,render:function(t,e,a,n){return a.status==1?'<i class="ti fs-4 ti-shield-check text-success"></i>':'<i class="ti fs-4 ti-shield-x text-danger"></i>'}},{targets:-1,searchable:!1,orderable:!1,render:function(t,e,a,n){return`<div class="d-flex align-items-center gap-50"><button class="btn btn-sm btn-icon edit-record btn-text-secondary rounded-pill waves-effect" data-id="${a.id}" data-bs-toggle="offcanvas" data-bs-target="#offcanvasAddUser"><i class="ti ti-edit"></i></button></div>`}}],language:{paginate:{next:'<i class="ti ti-chevron-right ti-sm"></i>',previous:'<i class="ti ti-chevron-left ti-sm"></i>'}},orderCellsTop:!0});$("input.dt-input").on("keyup",function(){i.ajax.reload(null,!1)}),$("#statuss").on("change",function(){i.ajax.reload(null,!1)})}$("#currency_id").on("change",function(){var t=$(this).find("option:selected");$("#symbol").val(t.data("symbol")),$("#country").val(t.data("country"))});$(".add-new").on("click",function(){$("#id").val(""),$("#offcanvasAddUserLabel").html("Add Chart Of Account")});$(document).on("click",".edit-record",function(){var t=$(this).data("id");$("#addChartofAccount").modal("show"),$("#offcanvasAddUserLabel").html("Edit Chart of Account"),$.get(`${baseUrl}chart-of-account/${t}/edit`,function(e){$("#user_id").val(e.id),$("#parent_account_id").val(e.parent_account_id).trigger("change"),$("#account").val(e.account_name),$("#debit_limit").val(e.debit_limit),$("#credit_limit").val(e.credit_limit),$("#prefixs").val(e.prefix),$("#account_type").val(e.account_type).trigger("change"),$("#sc_dc").val(e.sc_dc).trigger("change"),$("#currency_id").val(e.currency_id).trigger("change"),$("#status").val(e.status).trigger("change"),$("#re_value").val(e.re_value).trigger("change"),$("#cost_of_sale").val(e.cost_of_sale).trigger("change")})});FormValidation.formValidation(document.getElementById("addChartOfAccountForm"),{fields:{parent_account_id:{validators:{notEmpty:{message:"Please select Parent Account"}}},currency_id:{validators:{notEmpty:{message:"Please select Country"}}},account_name:{validators:{notEmpty:{message:"Please enter account name"}}},status:{validators:{notEmpty:{message:"Please select status"}}},re_value:{validators:{notEmpty:{message:"Please select Re Value"}}},profit:{validators:{notEmpty:{message:"Please select profit"}}},cost_of_sale:{validators:{notEmpty:{message:"Please select cost of sale"}}},debit_limit:{validators:{notEmpty:{message:"Please enter debit limit"},numeric:{message:"The value must be a valid number"}}},credit_limit:{validators:{notEmpty:{message:"Please select credit limit"},numeric:{message:"The value must be a valid number"}}}},plugins:{trigger:new FormValidation.plugins.Trigger,bootstrap5:new FormValidation.plugins.Bootstrap5({eleValidClass:"",rowSelector:".col-12"}),submitButton:new FormValidation.plugins.SubmitButton,autoFocus:new FormValidation.plugins.AutoFocus}}).on("core.form.valid",function(){$.ajax({data:$("#addChartOfAccountForm").serialize(),url:`${baseUrl}chart-of-account`,type:"POST",success:function(t){$("#addChartOfAccountForm")[0].reset(),$(".select2").val(null).trigger("change"),$("#addChartofAccount").modal("hide"),Swal.fire({icon:"success",title:`Successfully ${t}!`,text:`Currency ${t} Successfully.`,customClass:{confirmButton:"btn btn-success"}}),i.ajax.reload(null,!1)},error:function(){Swal.fire({title:"Duplicate Entry!",text:"Your email should be unique.",icon:"error",customClass:{confirmButton:"btn btn-success"}})}})});
